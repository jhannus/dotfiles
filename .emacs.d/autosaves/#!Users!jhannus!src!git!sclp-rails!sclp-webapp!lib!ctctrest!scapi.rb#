require 'ctctrest/persistent_rest_client'
require 'json'

module CtctRest
  class Scapi < PersistentRestClient

    def campaign(account_id, params)
      endpoint = "/customer/#{account_id}/campaign"
      if params.has_key? :id
        call_json(:get, endpoint + "/#{params[:id]}")
      else
        call_json(:post, endpoint, params)
      end
    end

    def active_campaign(account_id, page_id)
      endpoint = "/customer/#{account_id}/campaign/page/#{page_id}/active"
      call_json(:get, endpoint)
    end

    def page(account_id, params)
      endpoint = "/customer/#{account_id}/page"
      if params.has_key? :id
        call_json(:get, endpoint + "/#{params[:id]}/facebook")
      else
        call_json(:post, endpoint, params)
      end
    end
  
    def deauthorize(account_id, page_id)
      call(:put, "/customer/#{account_id}/page/#{page_id}/deauthorize") == 'true'
    end

  end
end
